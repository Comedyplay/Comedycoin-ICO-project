<%= render "user/header" %>
<main>
  <div class="container-fluid">
    <div class="middle-box">
      <div class="row">
        <%= render "user/links" %>
        <div class="col-md-9 col-12 col-sm-9">
          <div class="tab-content">
            <div class="tab-pane fade show active text-center identity" id="passport-photo" role="tabpanel">
              <%= link_to "", previous_wizard_path, class: "fa fa-angle-left pull-left", id: "passport-back" %>
              <h2 class="login-title">Identity</h2>
              <br>
              <br>
              <%= form_for [ @user, @user.user_profile ], url: wizard_path, method: :put do |f| %>
                <label class="attachment">
                  <i class="fa fa-upload"></i>
                  <br>
                  <img id="myImg" src="#" alt="your image" class="fade" height=250 width=400>
                  <h2 class="upload-text">Upload passport photo page from your computer<br> (or drop your file here)</h2>
                  <%= f.file_field :identity_photo, required: true, name: 'user_profile[identity_photo]', id: "image-preview"%>
                </label>
                  <br>
                <%= f.submit "Next", class: "btn create-btn"%>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <%= render "user/message_box" %>
    <a href="JavaScript:void(0);" class="help-btn"><i class="fa fa-question-circle-o"></i> HELP</a>
  </div>  
</main>

<script type="text/javascript">
  $(function () {
    $("#image-preview").change(function () {
      if (this.files && this.files[0]) {
        var reader = new FileReader();
        reader.onload = imageIsLoaded;
        reader.readAsDataURL(this.files[0]);
      }
    });
  });

  function imageIsLoaded(e) {
      $('#myImg').attr('src', e.target.result);
      $('#yourImage').attr('src', e.target.result);
  };
</script>